<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>NAME LAST NAME â€” AI CV Assistant</title>
  <meta name="description" content="Single-page AI CV Assistant chat interface (frontend-only) for an AWS API Gateway + Lambda backend." />
  <style>
    :root{
      --bg: #0b1220;
      --panel: rgba(255,255,255,0.06);
      --panel-2: rgba(255,255,255,0.10);
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.70);
      --muted-2: rgba(255,255,255,0.55);
      --border: rgba(255,255,255,0.12);
      --shadow: 0 18px 55px rgba(0,0,0,0.35);
      --shadow-soft: 0 10px 30px rgba(0,0,0,0.22);
      --accent: #7c5cff;
      --accent-2: #4dd6ff;
      --ok: #30d158;
      --warn: #ffd60a;
      --err: #ff453a;

      --bubble-user: rgba(124,92,255,0.18);
      --bubble-user-border: rgba(124,92,255,0.38);
      --bubble-assistant: rgba(255,255,255,0.08);
      --bubble-assistant-border: rgba(255,255,255,0.14);
      --bubble-error: rgba(255,69,58,0.12);
      --bubble-error-border: rgba(255,69,58,0.35);

      --ring: 0 0 0 4px rgba(124,92,255,0.25);

      --radius-lg: 20px;
      --radius-md: 14px;
      --radius-sm: 10px;

      --max-width: 1040px;
      --chat-height: 62vh;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    @media (prefers-color-scheme: light){
      :root{
        --bg: #f6f7fb;
        --panel: rgba(20,24,40,0.04);
        --panel-2: rgba(20,24,40,0.07);
        --text: rgba(16,18,28,0.92);
        --muted: rgba(16,18,28,0.70);
        --muted-2: rgba(16,18,28,0.58);
        --border: rgba(16,18,28,0.10);
        --shadow: 0 18px 55px rgba(0,0,0,0.12);
        --shadow-soft: 0 10px 30px rgba(0,0,0,0.08);

        --bubble-user: rgba(124,92,255,0.12);
        --bubble-user-border: rgba(124,92,255,0.28);
        --bubble-assistant: rgba(16,18,28,0.04);
        --bubble-assistant-border: rgba(16,18,28,0.10);
        --bubble-error: rgba(255,69,58,0.10);
        --bubble-error-border: rgba(255,69,58,0.25);

        --ring: 0 0 0 4px rgba(124,92,255,0.18);
      }
    }

    /* Manual theme override */
    html[data-theme="dark"]{
      --bg: #0b1220;
      --panel: rgba(255,255,255,0.06);
      --panel-2: rgba(255,255,255,0.10);
      --text: rgba(255,255,255,0.92);
      --muted: rgba(255,255,255,0.70);
      --muted-2: rgba(255,255,255,0.55);
      --border: rgba(255,255,255,0.12);
      --shadow: 0 18px 55px rgba(0,0,0,0.35);
      --shadow-soft: 0 10px 30px rgba(0,0,0,0.22);
      --bubble-user: rgba(124,92,255,0.18);
      --bubble-user-border: rgba(124,92,255,0.38);
      --bubble-assistant: rgba(255,255,255,0.08);
      --bubble-assistant-border: rgba(255,255,255,0.14);
      --bubble-error: rgba(255,69,58,0.12);
      --bubble-error-border: rgba(255,69,58,0.35);
      --ring: 0 0 0 4px rgba(124,92,255,0.25);
    }
    html[data-theme="light"]{
      --bg: #f6f7fb;
      --panel: rgba(20,24,40,0.04);
      --panel-2: rgba(20,24,40,0.07);
      --text: rgba(16,18,28,0.92);
      --muted: rgba(16,18,28,0.70);
      --muted-2: rgba(16,18,28,0.58);
      --border: rgba(16,18,28,0.10);
      --shadow: 0 18px 55px rgba(0,0,0,0.12);
      --shadow-soft: 0 10px 30px rgba(0,0,0,0.08);
      --bubble-user: rgba(124,92,255,0.12);
      --bubble-user-border: rgba(124,92,255,0.28);
      --bubble-assistant: rgba(16,18,28,0.04);
      --bubble-assistant-border: rgba(16,18,28,0.10);
      --bubble-error: rgba(255,69,58,0.10);
      --bubble-error-border: rgba(255,69,58,0.25);
      --ring: 0 0 0 4px rgba(124,92,255,0.18);
    }

    *{ box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin: 0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1200px 800px at 10% -10%, rgba(124,92,255,0.22), transparent 60%),
        radial-gradient(900px 700px at 90% 0%, rgba(77,214,255,0.18), transparent 55%),
        radial-gradient(900px 900px at 70% 110%, rgba(124,92,255,0.16), transparent 55%),
        var(--bg);
      line-height: 1.45;
      overflow-x: hidden;
    }

    a { color: inherit; }
    .skip-link{
      position: absolute;
      left: -999px;
      top: 10px;
      padding: 10px 12px;
      background: var(--panel-2);
      border: 1px solid var(--border);
      border-radius: 999px;
      box-shadow: var(--shadow-soft);
      z-index: 999;
    }
    .skip-link:focus{ left: 12px; outline: none; box-shadow: var(--ring), var(--shadow-soft); }

    .container{
      width: 100%;
      max-width: var(--max-width);
      margin: 0 auto;
      padding: 22px 16px 28px;
    }

    header{
      display: grid;
      gap: 14px;
      padding: 18px 18px 16px;
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--panel), transparent);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }

    .header-top{
      display: flex;
      gap: 10px;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .title-wrap{ display: grid; gap: 6px; }
    h1{
      font-size: clamp(18px, 2vw, 22px);
      margin: 0;
      letter-spacing: 0.2px;
      font-weight: 720;
    }
    .subtitle{
      margin: 0;
      color: var(--muted);
      max-width: 80ch;
      font-size: 14px;
    }

    .pill-row{
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    .pill{
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 9px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: var(--panel);
      box-shadow: 0 1px 0 rgba(255,255,255,0.03) inset;
      font-size: 12.5px;
      color: var(--muted);
    }
    .dot{
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--accent-2);
      box-shadow: 0 0 0 3px rgba(77,214,255,0.15);
    }

    .btn{
      appearance: none;
      border: 1px solid var(--border);
      background: var(--panel);
      color: var(--text);
      font: inherit;
      cursor: pointer;
      border-radius: 999px;
      padding: 10px 12px;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      transition: transform 120ms ease, background 120ms ease, border-color 120ms ease;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    .btn:hover{ transform: translateY(-1px); border-color: rgba(124,92,255,0.35); }
    .btn:active{ transform: translateY(0px); }
    .btn:focus{ outline: none; box-shadow: var(--ring); }
    .btn-primary{
      background: linear-gradient(180deg, rgba(124,92,255,0.28), rgba(124,92,255,0.10));
      border-color: rgba(124,92,255,0.40);
    }
    .btn-ghost{
      background: transparent;
    }
    .btn-danger{
      background: linear-gradient(180deg, rgba(255,69,58,0.18), rgba(255,69,58,0.06));
      border-color: rgba(255,69,58,0.32);
    }
    .btn[disabled]{
      opacity: 0.55;
      cursor: not-allowed;
      transform: none;
    }

    main{
      margin-top: 14px;
      display: grid;
      gap: 14px;
    }

    .card{
      border: 1px solid var(--border);
      background: var(--panel);
      border-radius: var(--radius-lg);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      overflow: hidden;
    }

    .chat-card{
      display: grid;
      grid-template-rows: auto 1fr auto;
      min-height: min(740px, calc(100vh - 220px));
    }

    .chat-header{
      padding: 14px 16px;
      border-bottom: 1px solid var(--border);
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
    }

    .chat-header .hint{
      color: var(--muted);
      font-size: 12.5px;
    }

    .chat-body{
      padding: 16px 14px;
      background:
        radial-gradient(800px 400px at 30% 20%, rgba(124,92,255,0.09), transparent 55%),
        radial-gradient(800px 420px at 80% 80%, rgba(77,214,255,0.07), transparent 58%),
        transparent;
      overflow: auto;
      overscroll-behavior: contain;
      scroll-behavior: smooth;
    }

    .messages{
      display: grid;
      gap: 10px;
      align-content: start;
      min-height: 10px;
    }

    .msg{
      display: grid;
      gap: 6px;
    }

    .bubble{
      width: fit-content;
      max-width: min(80ch, 92%);
      padding: 12px 12px;
      border-radius: 16px;
      border: 1px solid var(--bubble-assistant-border);
      background: var(--bubble-assistant);
      box-shadow: 0 1px 0 rgba(255,255,255,0.04) inset;
      white-space: pre-wrap;
      word-wrap: break-word;
      overflow-wrap: anywhere;
      position: relative;
    }
    .meta{
      font-size: 11.5px;
      color: var(--muted-2);
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .msg.assistant{ justify-items: start; }
    .msg.user{ justify-items: end; }
    .msg.user .bubble{
      border-color: var(--bubble-user-border);
      background: var(--bubble-user);
    }
    .msg.error{ justify-items: start; }
    .msg.error .bubble{
      border-color: var(--bubble-error-border);
      background: var(--bubble-error);
    }

    .bubble-actions{
      margin-top: 8px;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-end;
    }
    .chip{
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.05);
      color: var(--muted);
      font-size: 12px;
      padding: 7px 10px;
      border-radius: 999px;
      cursor: pointer;
      transition: transform 120ms ease, border-color 120ms ease, background 120ms ease;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    .chip:hover{ transform: translateY(-1px); border-color: rgba(77,214,255,0.30); }
    .chip:active{ transform: translateY(0); }
    .chip:focus{ outline: none; box-shadow: var(--ring); }
    .chip[disabled]{ opacity: 0.55; cursor: not-allowed; transform: none; }

    .typing{
      display: inline-flex;
      gap: 6px;
      align-items: center;
    }
    .dots{
      display: inline-flex;
      gap: 4px;
      align-items: center;
      height: 14px;
    }
    .dots span{
      width: 6px; height: 6px;
      border-radius: 50%;
      background: rgba(255,255,255,0.55);
      animation: bounce 1.05s infinite ease-in-out;
    }
    @media (prefers-color-scheme: light){
      .dots span{ background: rgba(16,18,28,0.45); }
    }
    html[data-theme="light"] .dots span{ background: rgba(16,18,28,0.45); }
    html[data-theme="dark"] .dots span{ background: rgba(255,255,255,0.55); }

    .dots span:nth-child(2){ animation-delay: 0.15s; }
    .dots span:nth-child(3){ animation-delay: 0.30s; }

    @keyframes bounce{
      0%, 80%, 100%{ transform: translateY(0); opacity: 0.55; }
      40%{ transform: translateY(-5px); opacity: 1; }
    }

    .chat-footer{
      padding: 12px 12px 12px;
      border-top: 1px solid var(--border);
      background: linear-gradient(180deg, transparent, rgba(0,0,0,0.06));
    }
    @media (prefers-color-scheme: light){
      .chat-footer{ background: linear-gradient(180deg, transparent, rgba(0,0,0,0.03)); }
    }

    .composer{
      display: grid;
      gap: 10px;
    }

    .input-row{
      display: grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items: end;
    }

    .field{
      display: grid;
      gap: 8px;
    }

    textarea{
      width: 100%;
      resize: none;
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 12px 12px;
      font: inherit;
      color: var(--text);
      background: rgba(255,255,255,0.04);
      box-shadow: 0 1px 0 rgba(255,255,255,0.03) inset;
      min-height: 46px;
      max-height: 170px;
      overflow-y: auto;
      outline: none;
      transition: box-shadow 120ms ease, border-color 120ms ease, background 120ms ease;
    }
    textarea:focus{
      box-shadow: var(--ring), 0 1px 0 rgba(255,255,255,0.03) inset;
      border-color: rgba(124,92,255,0.45);
      background: rgba(255,255,255,0.06);
    }

    .controls{
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      justify-content: flex-end;
      align-items: center;
    }

    .counter{
      font-size: 12px;
      color: var(--muted-2);
      display: flex;
      justify-content: space-between;
      gap: 10px;
      align-items: center;
    }
    .counter strong{
      font-family: var(--mono);
      font-weight: 650;
      color: var(--muted);
    }
    .counter .near{ color: var(--warn); }
    .counter .over{ color: var(--err); }

    .sr-only{
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0,0,0,0);
      white-space: nowrap;
      border: 0;
    }

    details{
      border-top: 1px solid var(--border);
      padding: 0;
    }
    details summary{
      list-style: none;
      cursor: pointer;
      padding: 14px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    details summary::-webkit-details-marker{ display: none; }
    .summary-title{
      font-weight: 650;
      letter-spacing: 0.2px;
      display: inline-flex;
      gap: 10px;
      align-items: center;
    }
    .chev{
      width: 10px;
      height: 10px;
      border-right: 2px solid var(--muted);
      border-bottom: 2px solid var(--muted);
      transform: rotate(45deg);
      transition: transform 150ms ease;
      opacity: 0.85;
    }
    details[open] .chev{ transform: rotate(225deg); }
    .arch{
      padding: 0 16px 16px;
      color: var(--muted);
      font-size: 13.5px;
      display: grid;
      gap: 10px;
    }
    .arch .k{
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-family: var(--mono);
      font-size: 12.5px;
      color: var(--muted);
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.04);
      width: fit-content;
    }

    .footer-note{
      padding: 10px 16px 14px;
      color: var(--muted-2);
      font-size: 12.5px;
      display: flex;
      justify-content: space-between;
      gap: 10px;
      flex-wrap: wrap;
      border-top: 1px solid var(--border);
      background: linear-gradient(180deg, transparent, rgba(0,0,0,0.04));
    }
    @media (prefers-color-scheme: light){
      .footer-note{ background: linear-gradient(180deg, transparent, rgba(0,0,0,0.02)); }
    }

    .kbd{
      font-family: var(--mono);
      font-size: 11.5px;
      padding: 3px 6px;
      border-radius: 7px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.05);
      color: var(--muted);
    }

    /* Responsive tweaks */
    @media (max-width: 720px){
      .chat-card{ min-height: min(760px, calc(100vh - 210px)); }
      .input-row{ grid-template-columns: 1fr; }
      .controls{ justify-content: space-between; }
      .chat-header{ align-items: flex-start; }
    }

    /* Visible focus outline for non-button interactive elements */
    summary:focus, details summary:focus { outline: none; box-shadow: var(--ring); border-radius: 12px; }

    /* Reduced motion */
    @media (prefers-reduced-motion: reduce){
      *{ scroll-behavior: auto !important; transition: none !important; animation: none !important; }
    }
  </style>
</head>
<body>
  <a class="skip-link" href="#chat">Skip to chat</a>

  <div class="container">
    <header>
      <div class="header-top">
        <div class="title-wrap">
          <h1>NAME LAST NAME â€“ AI CV Assistant</h1>
          <p class="subtitle">
            Hello! I am an AI assistant trained on this professional profile. Please feel free to ask me about specific work experience, educational background, technical projects, or any other details you find useful for your evaluation.
          </p>
        </div>

        <div class="pill-row">
          <span class="pill" title="Frontend-only UI">
            <span class="dot" aria-hidden="true"></span>
            Frontend-only â€¢ GitHub Pages
          </span>
          <button id="themeToggle" class="btn btn-ghost" type="button" aria-label="Toggle dark or light mode">
            <span aria-hidden="true">ðŸŒ“</span>
            <span>Theme</span>
          </button>
        </div>
      </div>
    </header>

    <main>
      <section class="card chat-card" aria-label="Chat card">
        <div class="chat-header">
          <div class="hint">
            Tip: <span class="kbd">Enter</span> to send â€¢ <span class="kbd">Shift</span> + <span class="kbd">Enter</span> for a new line
          </div>
          <div class="pill-row">
            <button id="clearBtn" class="btn btn-danger" type="button" aria-label="Clear chat">ðŸ§¹ Clear chat</button>
          </div>
        </div>

        <div id="chat" class="chat-body" role="region" aria-label="Conversation" tabindex="0">
          <div id="messages" class="messages" aria-live="polite" aria-relevant="additions text"></div>
          <div class="sr-only" id="liveStatus" aria-live="polite"></div>
        </div>

        <div class="chat-footer">
          <div class="composer">
            <div class="field">
              <label class="sr-only" for="input">Message</label>
              <div class="input-row">
                <textarea
                  id="input"
                  aria-label="Message input"
                  placeholder="Ask about experience, projects, educationâ€¦"
                  maxlength="4000"
                  rows="1"
                ></textarea>

                <div class="controls">
                  <button id="sendBtn" class="btn btn-primary" type="button" aria-label="Send message">
                    <span aria-hidden="true">âž¤</span>
                    <span>Send</span>
                  </button>
                </div>
              </div>

              <div class="counter" aria-label="Character counter">
                <span>
                  Input limit: <strong id="limitLabel">4000</strong> chars
                </span>
                <span id="counterValue"><strong>0</strong>/4000</span>
              </div>
            </div>
          </div>
        </div>

        <details>
          <summary>
            <span class="summary-title">
              <span aria-hidden="true">ðŸ§©</span>
              Architecture (how this chatbot works)
            </span>
            <span class="chev" aria-hidden="true"></span>
          </summary>
          <div class="arch">
            <div class="k">Frontend: GitHub Pages</div>
            <p>
              This page is a static, single-file web app. Your browser sends your message to an AWS API Gateway HTTP API endpoint using <span class="kbd">POST /chat</span>.
              The backend is implemented with AWS Lambda, which calls a large language model and returns a JSON response containing the assistant reply.
            </p>
            <div class="k">API Gateway â†’ Lambda</div>
            <p>
              The API enables CORS for <span class="kbd">https://juliabaucher.github.io</span>. The Lambda function handles <span class="kbd">OPTIONS</span> preflight requests and sets the appropriate
              <span class="kbd">Access-Control-Allow-Origin</span> headers so this GitHub Pages frontend can talk to the backend securely.
            </p>
            <div class="k">Security & safety</div>
            <p>
              Messages are rendered as plain text (no HTML rendering) to reduce XSS risk. Errors are displayed in a friendly way, with optional technical details if the backend provides them.
            </p>
          </div>
        </details>

        <div class="footer-note">
          <span>Local chat persistence: <span class="kbd">enabled</span> (client-side only)</span>
          <span>Status: <span id="statusPill" class="kbd">Ready</span></span>
        </div>
      </section>

      <!-- Feedback & Missing Frontend Considerations (Do Not Remove)
      - No explicit message state model is defined (IDs, roles, retries)
      - Retry UX is mentioned but not clearly specified
      - No fetch timeout or AbortController requirement
      - No accessibility guidance for the loading indicator (ARIA live regions)
      - No user feedback defined after â€œCopy to Clipboardâ€
      - No distinction between network errors and backend errors
      - No guidance for mobile virtual keyboard viewport handling
      - No versioning strategy for local storage persistence
      -->
    </main>
  </div>

  <script>
    // ==========================
    // CONFIG (EDIT THIS ONLY)
    // ==========================
    const API_BASE_URL = "https://YOUR_API_ID.execute-api.YOUR_REGION.amazonaws.com/prod"; // <-- set your API Gateway base URL (no trailing slash)
    const CHAT_PATH = "/chat";
    const INPUT_LIMIT = 4000;

    // Storage keys
    const STORAGE_KEY = "ai_cv_chat_v1";
    const THEME_KEY = "ai_cv_theme";

    // DOM
    const messagesEl = document.getElementById("messages");
    const chatEl = document.getElementById("chat");
    const inputEl = document.getElementById("input");
    const sendBtn = document.getElementById("sendBtn");
    const clearBtn = document.getElementById("clearBtn");
    const counterValue = document.getElementById("counterValue");
    const limitLabel = document.getElementById("limitLabel");
    const statusPill = document.getElementById("statusPill");
    const liveStatus = document.getElementById("liveStatus");
    const themeToggle = document.getElementById("themeToggle");

    limitLabel.textContent = String(INPUT_LIMIT);

    // ==========================
    // UTILITIES (SAFE TEXT ONLY)
    // ==========================
    function toPlainText(value){
      // Ensure we never render HTML. Convert anything to string and normalize.
      const s = (value === null || value === undefined) ? "" : String(value);
      return s.replace(/\r\n/g, "\n");
    }

    function nowTime(){
      const d = new Date();
      return d.toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
    }

    function setStatus(text){
      statusPill.textContent = text;
    }

    function announce(text){
      // For screen readers
      liveStatus.textContent = "";
      // Slight delay helps some AT read consecutive updates
      window.setTimeout(() => { liveStatus.textContent = text; }, 30);
    }

    function autoScroll(){
      // Always scroll to bottom after new messages
      chatEl.scrollTop = chatEl.scrollHeight;
    }

    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

    function resizeTextarea(){
      inputEl.style.height = "auto";
      const max = 170;
      inputEl.style.height = clamp(inputEl.scrollHeight, 46, max) + "px";
    }

    function updateCounter(){
      const len = inputEl.value.length;
      counterValue.innerHTML = "";
      const strong = document.createElement("strong");
      strong.textContent = String(len);
      const span = document.createElement("span");
      span.textContent = "/" + INPUT_LIMIT;
      counterValue.appendChild(strong);
      counterValue.appendChild(span);

      const ratio = len / INPUT_LIMIT;
      counterValue.classList.remove("near", "over");
      if (len > INPUT_LIMIT) counterValue.classList.add("over");
      else if (ratio >= 0.85) counterValue.classList.add("near");

      // Input validation
      const trimmed = inputEl.value.trim();
      const disabled = trimmed.length === 0 || len > INPUT_LIMIT;
      sendBtn.disabled = disabled;
    }

    function persistChat(messages){
      try{
        localStorage.setItem(STORAGE_KEY, JSON.stringify({ v: 1, savedAt: Date.now(), messages }));
